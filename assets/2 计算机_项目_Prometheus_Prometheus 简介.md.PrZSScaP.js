import{_ as t,o as e,c as i,ag as a}from"./chunks/framework.DEqXEGcv.js";const u=JSON.parse('{"title":"Prometheus简介","description":"","frontmatter":{},"headers":[],"relativePath":"2 计算机/项目/Prometheus/Prometheus 简介.md","filePath":"2 计算机/项目/Prometheus/Prometheus 简介.md","lastUpdated":1770889489000}'),r={name:"2 计算机/项目/Prometheus/Prometheus 简介.md"};function n(l,s,h,o,p,m){return e(),i("div",null,[...s[0]||(s[0]=[a(`<h1 id="prometheus简介" tabindex="-1">Prometheus简介 <a class="header-anchor" href="#prometheus简介" aria-label="Permalink to &quot;Prometheus简介&quot;">​</a></h1> <p>#Prometheus</p> <h2 id="简介" tabindex="-1">简介 <a class="header-anchor" href="#简介" aria-label="Permalink to &quot;简介&quot;">​</a></h2> <p>Prometheus 是云原生计算基金会的一个项目，是一个系统和服务<strong>监控系统</strong>。它以给定的时间间隔从配置的目标收集指标，评估规则表达式，显示结果，并在观察到指定条件时触发警报。</p> <h3 id="监控的目的" tabindex="-1">监控的目的 <a class="header-anchor" href="#监控的目的" aria-label="Permalink to &quot;监控的目的&quot;">​</a></h3> <p>监控系统分为黑盒监控和白盒监控：</p> <ol><li>白盒监控能够了解系统内部的实际<strong>运行状态</strong>，通过对<strong>监控指标</strong>的观察能够预判可能出现的问题，从而对潜在的不确定因素进行优化。</li> <li>黑盒监控，常见的如<strong>HTTP探针，TCP探针</strong>等，可以在系统或者服务在发生故障时能够快速通知相关的人员进行处理。</li></ol> <p>监控的目的：</p> <ul><li><strong>长期趋势分析</strong>：通过对监控样本数据的持续收集和统计，对监控指标进行长期趋势分析。例如，通过对磁盘空间增长率的判断，我们可以提前预测在未来什么时间节点上需要对资源进行扩容。</li> <li><strong>对照分析</strong>：两个版本的系统运行资源使用情况的差异如何？在不同容量情况下系统的并发和负载变化如何？通过监控能够方便的对系统进行跟踪和比较。</li> <li><strong>告警</strong>：当系统出现或者即将出现故障时，监控系统需要迅速反应并通知管理员，从而能够对问题进行快速的处理或者提前预防问题的发生，避免出现对业务的影响。</li> <li><strong>故障分析与定位</strong>：当问题发生后，需要对问题进行调查和处理。通过对不同监控监控以及历史数据的分析，能够找到并解决根源问题。</li> <li><strong>数据可视化</strong>：通过可视化仪表盘能够直接获取系统的运行状态、资源使用情况、以及服务运行状态等直观的信息。</li></ul> <h3 id="数据模型" tabindex="-1">数据模型 <a class="header-anchor" href="#数据模型" aria-label="Permalink to &quot;数据模型&quot;">​</a></h3> <p>Prometheus采集的监控数据均以指标(metric)的形式保存在内置的<strong>时间序列数据库</strong>当中(TSDB)。所有的样本除了基本的指标名称以外，还包含一组用于描述该样本特征的标签，基于这些标签可以方便地对监控数据进行<strong>聚合，过滤，裁剪</strong>。</p> <div class="language-SHELL vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">SHELL</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http_request_status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{code=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;200&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,content_path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;/api/path&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> environment=&#39;produment&#39;}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [value1@timestamp1,value2@timestamp2...]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http_request_status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{code=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;200&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,content_path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;/api/path2&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> environment=&#39;produment&#39;}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [value1@timestamp1,value2@timestamp2...]</span></span></code></pre> <div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="查询语言promql" tabindex="-1">查询语言PromQL <a class="header-anchor" href="#查询语言promql" aria-label="Permalink to &quot;查询语言PromQL&quot;">​</a></h3> <p>Prometheus内置数据查询语言PromQL。 通过PromQL可以实现对监控数据的查询、聚合。同时PromQL也被应用于数据可视化(如Grafana)以及告警当中。</p> <p>PromQL可以实现包括以下功能：</p> <ul><li>指标的分布范围</li> <li>预测一段时间之后的指标值</li> <li>过滤 TopN 的指标</li> <li>……</li></ul> <h2 id="prometheus架构" tabindex="-1">Prometheus架构 <a class="header-anchor" href="#prometheus架构" aria-label="Permalink to &quot;Prometheus架构&quot;">​</a></h2> <p><a href="https://www.prometheus.wang/quickstart/prometheus-arch.html" target="_blank" rel="noreferrer">Prometheus核心组件</a></p> <p><img src="https://blog-1312962011.cos.ap-nanjing.myqcloud.com/1312962011Prometheus%E6%9E%B6%E6%9E%84.png" alt="Prometheus架构.png" loading="lazy"></p> <ol><li><strong>Prometheus Server</strong>是Prometheus组件中的核心部分，负责实现对监控数据的获取，存储以及查询。</li> <li><strong>Exporter</strong>将监控数据采集的端点通过HTTP服务的形式暴露给Prometheus Server，一般来说可以将Exporter分为2类：
<ol><li>直接采集：直接内置了对Prometheus监控的支持</li> <li>间接采集：通过Prometheus提供的Client Library编写该监控目标的监控采集程序</li></ol></li> <li>在Prometheus Server中支持基于PromQL创建告警规则，如果满足PromQL定义的规则，则会产生一条告警，而告警的后续处理流程则由<strong>AlertManager</strong>进行管理。</li> <li><strong>PushGateway</strong> 用于无法拉取指标的临时任务，相当于指标缓存器</li></ol>`,38)])])}const d=t(r,[["render",n]]);export{u as __pageData,d as default};
